<html><head><title>Application Development in Android - Week 5 - Lab Guide</title><style type="text/css">@import url('https://themes.googleusercontent.com/fonts/css?kit=lhDjYqiy3mZ0x6ROQEUoUw');ol{margin:0;padding:0}.c13{vertical-align:top;width:468pt;border-style:solid;border-color:#000000;border-width:1pt;padding:5pt 5pt 5pt 5pt}.c17{max-width:468pt;background-color:#ffffff;padding:72pt 72pt 72pt 72pt}.c8{color:#666666;font-size:12pt;font-weight:bold}.c6{color:#1155cc;text-decoration:underline}.c3{font-size:9pt;font-family:"Consolas"}.c0{color:inherit;text-decoration:inherit}.c1{line-height:1.0;direction:ltr}.c7{text-align:center;padding-bottom:0pt}.c15{text-align:center}.c2{direction:ltr}.c21{font-size:13pt}.c5{border-collapse:collapse}.c11{text-align:left}.c4{height:11pt}.c12{font-weight:bold}.c14{text-indent:36pt}.c19{text-align:right}.c18{margin-left:36pt}.c16{height:0pt}.c9{font-style:italic}.c10{margin-left:72pt}.c20{font-size:14pt}.title{padding-top:24pt;line-height:1.15;text-align:justify;color:#000000;font-size:36pt;font-family:"Times New Roman";font-weight:bold;padding-bottom:6pt}.subtitle{padding-top:18pt;line-height:1.15;text-align:justify;color:#666666;font-style:italic;font-size:24pt;font-family:"Georgia";padding-bottom:4pt}li{color:#000000;font-size:11pt;font-family:"Times New Roman"}p{color:#000000;font-size:11pt;margin:0;font-family:"Times New Roman"}h1{padding-top:24pt;line-height:1.15;text-align:justify;color:#000000;font-size:18pt;font-family:"Times New Roman";font-weight:bold;padding-bottom:6pt}h2{padding-top:18pt;line-height:1.15;text-align:justify;color:#000000;font-size:13pt;font-family:"Times New Roman";font-weight:bold;padding-bottom:4pt}h3{padding-top:14pt;line-height:1.15;text-align:justify;color:#666666;font-size:12pt;font-family:"Times New Roman";font-weight:bold;padding-bottom:4pt}h4{padding-top:12pt;line-height:1.15;text-align:justify;color:#666666;font-style:italic;font-size:11pt;font-family:"Times New Roman";padding-bottom:2pt}h5{padding-top:11pt;line-height:1.15;text-align:justify;color:#666666;font-size:10pt;font-family:"Times New Roman";font-weight:bold;padding-bottom:2pt}h6{padding-top:10pt;line-height:1.15;text-align:justify;color:#666666;font-style:italic;font-size:10pt;font-family:"Times New Roman";padding-bottom:2pt}</style></head><body class="c17"><div><p class="c2 c4"><span></span></p></div><h1 class="c2 c7"><a name="h.3svynsq74t25"></a><span>Application Development in Android</span></h1><p class="c15 c2"><span class="c20">Lab Guide - Week 5</span></p><p class="c15 c2"><span class="c21">Mobile Computing - 2012/13</span></p><p class="c2 c15"><span class="c21">MEIC/MERC</span></p><h2 class="c2"><a name="h.2x8xc8suoj1o"></a><span class="c21">Objectives</span></h2><p class="c2"><span>The goal of this class is to provide some guidance to the beginners in Android app development. First, we show how to use the Android samples, a good way to quickly learn the capabilities of Android and its APIs. Second, we guide you through the implementation of two apps, which focus on some basic networking concepts. Lastly, we provide extra material that can be used to get additional guidance on application development for Android. In this class, we use Android 4.2.2.</span></p><h2 class="c2"><a name="h.tot8j3fdf1i6"></a><span>1. Explore the Android Samples</span></h2><p class="c2"><span>Android is a framework with extremely rich APIs that programmers can leverage for implementing their apps. One good way to start exploring the APIs and to check what Android can do is to look at the samples shipped with Android&rsquo;s SDK. In this assignment, we will take a look at the Android SDK samples and try one of them by following the instructions in this tutorial:</span></p><p class="c2"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c6"><a class="c0" href="http://mobile.tutsplus.com/tutorials/android/android-sample-apps/">http://mobile.tutsplus.com/tutorials/android/android-sample-apps/</a></span></p><p class="c2 c4"><span></span></p><p class="c2"><span>In addition to these apps, you can</span><span>&nbsp;explore many other examples available on the Internet. To understand the code, the</span><span>&nbsp;API documentation available on the Android website comes in handy.</span></p><h2 class="c2"><a name="h.ynel4o4ttlzk"></a><span>2. Build Two Simple Apps</span></h2><p class="c2"><span>Now that we have an idea of what Android can do, let&rsquo;s start doing. In this section, we explore some of Android&rsquo;s basic networking features by building two apps. We present them in turn.</span></p><h3 class="c2"><a name="h.8heh6j906uzp"></a><span>2.1 Client-Server Using TCP/IP Sockets</span></h3><p class="c2"><span>In this assignment, we create a client-server using TCP/IP sockets. The server is a standalone Java application running on the host, and the client is a mobile app running on the Android emulator. The client asks the user for a message and sends it to the server. The server displays the message.</span></p><p class="c2 c4"><span></span></p><p class="c2"><span>1. Implement the server as described next.</span></p><p class="c2 c4"><span></span></p><p class="c2"><span>1.1. In Eclipse, create a new Java Project for the server. Call the project &ldquo;CMov-CS-Server&rdquo;. Accept all the default settings.</span></p><p class="c2 c4"><span></span></p><p class="c2"><span>1.2. Implement a simple server that waits on a socket for a client to connect, receives a message from the client, and prints the received message on the console. Use the following source code for the </span><span class="c9">Main.java</span><span>. Place the file under the package name &ldquo;pt.utl.ist.cmov.csserver&rdquo;.</span></p><p class="c2 c4"><span></span></p><a href="#" name="c93f859b4745ca6808c517f9a01fef021f2141e1"></a><a href="#" name="0"></a><table cellpadding="0" cellspacing="0" class="c5"><tbody><tr><td class="c13"><p class="c1"><span class="c3">package pt.utl.ist.cmov.csserver;</span></p><p class="c1"><span class="c3">&nbsp;</span></p><p class="c1"><span class="c3">import java.io.BufferedReader;</span></p><p class="c1"><span class="c3">import java.io.IOException;</span></p><p class="c1"><span class="c3">import java.io.InputStreamReader;</span></p><p class="c1"><span class="c3">import java.net.ServerSocket;</span></p><p class="c1"><span class="c3">import java.net.Socket;</span></p><p class="c1"><span class="c3">&nbsp;</span></p><p class="c1"><span class="c3">public class Main {</span></p><p class="c1"><span class="c3">&nbsp;</span></p><p class="c1"><span class="c3">&nbsp; &nbsp; private static ServerSocket serverSocket;</span></p><p class="c1"><span class="c3">&nbsp; &nbsp; private static Socket clientSocket;</span></p><p class="c1"><span class="c3">&nbsp; &nbsp; private static InputStreamReader inputStreamReader;</span></p><p class="c1"><span class="c3">&nbsp; &nbsp; private static BufferedReader bufferedReader;</span></p><p class="c1"><span class="c3">&nbsp; &nbsp; private static String message;</span></p><p class="c1"><span class="c3">&nbsp;</span></p><p class="c1"><span class="c3">&nbsp; &nbsp; public static void main(String[] args) {</span></p><p class="c1"><span class="c3">&nbsp;</span></p><p class="c1"><span class="c3">&nbsp; &nbsp; &nbsp; &nbsp; try {</span></p><p class="c1"><span class="c3">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; serverSocket = new ServerSocket(4444);</span></p><p class="c1"><span class="c3">&nbsp; &nbsp; &nbsp; &nbsp; } catch (IOException e) {</span></p><p class="c1"><span class="c3">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; System.out.println(&quot;Could not listen on port: 4444&quot;);</span></p><p class="c1"><span class="c3">&nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c1"><span class="c3">&nbsp;</span></p><p class="c1"><span class="c3">&nbsp; &nbsp; &nbsp; &nbsp; System.out.println(&quot;Server started. Listening to the port 4444&quot;);</span></p><p class="c1"><span class="c3">&nbsp;</span></p><p class="c1"><span class="c3">&nbsp; &nbsp; &nbsp; &nbsp; while (true) {</span></p><p class="c1"><span class="c3">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; try {</span></p><p class="c1"><span class="c3">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; clientSocket = serverSocket.accept();</span></p><p class="c1"><span class="c3">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; inputStreamReader = </span></p><p class="c1"><span class="c3">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;new InputStreamReader(clientSocket.getInputStream());</span></p><p class="c1"><span class="c3">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bufferedReader = </span></p><p class="c1"><span class="c3">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;new BufferedReader(inputStreamReader);</span></p><p class="c1"><span class="c3">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; message = bufferedReader.readLine();</span></p><p class="c1"><span class="c3">&nbsp;</span></p><p class="c1"><span class="c3">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; System.out.println(message);</span></p><p class="c1"><span class="c3">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; inputStreamReader.close();</span></p><p class="c1"><span class="c3">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; clientSocket.close();</span></p><p class="c1"><span class="c3">&nbsp;</span></p><p class="c1"><span class="c3">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; } catch (IOException ex) {</span></p><p class="c1"><span class="c3">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; System.out.println(&quot;Problem in message reading&quot;);</span></p><p class="c1"><span class="c3">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c1"><span class="c3">&nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c1"><span class="c3">&nbsp; &nbsp; }</span></p><p class="c1"><span class="c3">}</span></p></td></tr></tbody></table><p class="c2 c4"><span></span></p><p class="c2"><span>1.3 Create a new Java Application configuration for the server project (Run &rarr; &ldquo;Run Configurations...&rdquo;). Name this configuration &ldquo;CMov-CS-Server&rdquo;.</span></p><p class="c2 c4"><span></span></p><p class="c2"><span>1.4. Build and execute the server by pressing </span><img height="20" src="images/image00.png" width="20"><span>&nbsp;on the &ldquo;CMov-CS-Server&rdquo;. The server should now be listening on the local port 4444. The message &ldquo;</span><span class="c3">Server started. Listening to the port 4444</span><span>&rdquo; should have been printed on the Eclipse&rsquo;s console.</span></p><p class="c2 c4"><span></span></p><p class="c2"><span>2. Implement the client as described next.</span></p><p class="c2 c4"><span></span></p><p class="c2"><span>2.1 Create a new Android Application Project. Call it &ldquo;CMov-CS-Client&rdquo;. Set the package name to be &ldquo;pt.utl.ist.cmov.csclient&rdquo;. Accept all the remainder default settings.</span></p><p class="c2 c4"><span></span></p><p class="c2"><span>2.2. Then, modify the layout so that the user can submit a string of text to the server. To enable this, define an edit text and a button. Below, you can find the resulting </span><span class="c9">res/activity_main.xml</span><span>&nbsp;file.</span></p><p class="c2 c4"><span></span></p><a href="#" name="f410f413fe688bd61bfd6c90304d63cc5515ab1c"></a><a href="#" name="1"></a><table cellpadding="0" cellspacing="0" class="c5"><tbody><tr><td class="c13"><p class="c1"><span class="c3">&lt;LinearLayout android:layout_height=&quot;fill_parent&quot;</span></p><p class="c1"><span class="c3">&nbsp; &nbsp; android:layout_width=&quot;fill_parent&quot;</span></p><p class="c1"><span class="c3">&nbsp; &nbsp; android:orientation=&quot;vertical&quot;</span></p><p class="c1"><span class="c3">&nbsp; &nbsp; xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;&gt;</span></p><p class="c1"><span class="c3">&nbsp;</span></p><p class="c1"><span class="c3">&nbsp; &nbsp; &lt;EditText android:id=&quot;@+id/editText1&quot;</span></p><p class="c1"><span class="c3">&nbsp; &nbsp; &nbsp; &nbsp; android:inputType=&quot;textMultiLine&quot;</span></p><p class="c1"><span class="c3">&nbsp; &nbsp; &nbsp; &nbsp; android:layout_height=&quot;wrap_content&quot;</span></p><p class="c1"><span class="c3">&nbsp; &nbsp; &nbsp; &nbsp; android:layout_width=&quot;match_parent&quot;&gt;</span></p><p class="c1"><span class="c3">&nbsp; &nbsp; &lt;/EditText&gt;</span></p><p class="c1"><span class="c3">&nbsp;</span></p><p class="c1"><span class="c3">&nbsp; &nbsp; &lt;Button android:id=&quot;@+id/button1&quot;</span></p><p class="c1"><span class="c3">&nbsp; &nbsp; &nbsp; &nbsp; android:layout_gravity=&quot;center&quot;</span></p><p class="c1"><span class="c3">&nbsp; &nbsp; &nbsp; &nbsp; android:layout_height=&quot;wrap_content&quot;</span></p><p class="c1"><span class="c3">&nbsp; &nbsp; &nbsp; &nbsp; android:layout_width=&quot;wrap_content&quot;</span></p><p class="c1"><span class="c3">&nbsp; &nbsp; &nbsp; &nbsp; android:text=&quot;@string/send&quot;&gt; </span></p><p class="c1"><span class="c3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/Button&gt;</span></p><p class="c1 c4"><span class="c3"></span></p><p class="c1"><span class="c3">&lt;/LinearLayout&gt;</span></p></td></tr></tbody></table><p class="c2 c4"><span></span></p><p class="c2"><span>Don&rsquo;t forget to edit the </span><span class="c9">values/string.xml</span><span>&nbsp;file and add a string relative to &ldquo;@string/send&rdquo;. Here&rsquo;s the content of </span><span class="c9">values/string.xml</span><span>&nbsp;after making the change:</span></p><p class="c2 c4"><span></span></p><a href="#" name="57341fa1e04b8b5d4ce8a4b68a21954f45577a1b"></a><a href="#" name="2"></a><table cellpadding="0" cellspacing="0" class="c5"><tbody><tr class="c16"><td class="c13"><p class="c1"><span class="c3">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span></p><p class="c1"><span class="c3">&lt;resources&gt;</span></p><p class="c1 c4"><span class="c3"></span></p><p class="c1"><span class="c3">&nbsp; &nbsp; &lt;string name=&quot;app_name&quot;&gt;CMov-CS-Client&lt;/string&gt;</span></p><p class="c1"><span class="c3">&nbsp; &nbsp; &lt;string name=&quot;action_settings&quot;&gt;Settings&lt;/string&gt;</span></p><p class="c1"><span class="c3">&nbsp; &nbsp; &lt;string name=&quot;hello_world&quot;&gt;Hello world!&lt;/string&gt;</span></p><p class="c1"><span class="c3">&nbsp; &nbsp; </span><span class="c3 c12">&lt;string name=&quot;send&quot;&gt;Send&lt;/string&gt;</span></p><p class="c1"><span class="c3">&nbsp; &nbsp; </span></p><p class="c1"><span class="c3">&lt;/resources&gt;</span></p></td></tr></tbody></table><p class="c2 c4"><span></span></p><p class="c2"><span>2.3. Modify the manifest to make sure that the app has permissions to access the network.</span></p><p class="c2 c4"><span></span></p><a href="#" name="42abe9494d3e2b92874116d2a9c9a64e3cd9a4ec"></a><a href="#" name="3"></a><table cellpadding="0" cellspacing="0" class="c5"><tbody><tr><td class="c13"><p class="c1"><span class="c3">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span></p><p class="c1"><span class="c3">&lt;manifest xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;</span></p><p class="c1"><span class="c3">&nbsp; &nbsp; package=&quot;pt.utl.ist.cmov.csclient&quot;</span></p><p class="c1"><span class="c3">&nbsp; &nbsp; android:versionCode=&quot;1&quot; android:versionName=&quot;1.0&quot; &gt;</span></p><p class="c1 c4"><span class="c3"></span></p><p class="c1"><span class="c3">&nbsp; &nbsp; &lt;uses-sdk</span></p><p class="c1"><span class="c3">&nbsp; &nbsp; &nbsp; &nbsp; android:minSdkVersion=&quot;8&quot;</span></p><p class="c1"><span class="c3">&nbsp; &nbsp; &nbsp; &nbsp; android:targetSdkVersion=&quot;17&quot; /&gt;</span></p><p class="c1 c4"><span class="c3"></span></p><p class="c1"><span class="c3 c12">&nbsp; &nbsp; &lt;uses-permission android:name=&quot;android.permission.INTERNET&quot;&gt;</span></p><p class="c1"><span class="c3 c12">&nbsp; &nbsp; &lt;/uses-permission&gt;</span></p><p class="c1 c4"><span class="c3"></span></p><p class="c1"><span class="c3">&nbsp; &nbsp; &lt;application</span></p><p class="c1"><span class="c3">&nbsp; &nbsp; &nbsp; &nbsp; android:allowBackup=&quot;true&quot;</span></p><p class="c1"><span class="c3">&nbsp; &nbsp; &nbsp; &nbsp; android:icon=&quot;@drawable/ic_launcher&quot;</span></p><p class="c1"><span class="c3">&nbsp; &nbsp; &nbsp; &nbsp; android:label=&quot;@string/app_name&quot;</span></p><p class="c1"><span class="c3">&nbsp; &nbsp; &nbsp; &nbsp; android:theme=&quot;@style/AppTheme&quot; &gt;</span></p><p class="c1"><span class="c3">&nbsp; &nbsp; &nbsp; &nbsp; &lt;activity</span></p><p class="c1"><span class="c3">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; android:name=&quot;.MainActivity&quot;</span></p><p class="c1"><span class="c3">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; android:label=&quot;@string/app_name&quot; &gt;</span></p><p class="c1"><span class="c3">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;intent-filter&gt;</span></p><p class="c1"><span class="c3">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;action android:name=&quot;android.intent.action.MAIN&quot; /&gt;</span></p><p class="c1 c4"><span class="c3"></span></p><p class="c1"><span class="c3">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;category android:name=&quot;android.intent.category.LAUNCHER&quot; /&gt;</span></p><p class="c1"><span class="c3">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;/intent-filter&gt;</span></p><p class="c1"><span class="c3">&nbsp; &nbsp; &nbsp; &nbsp; &lt;/activity&gt;</span></p><p class="c1"><span class="c3">&nbsp; &nbsp; &lt;/application&gt;</span></p><p class="c1 c4"><span class="c3"></span></p><p class="c1"><span class="c3">&lt;/manifest&gt;</span></p></td></tr></tbody></table><p class="c2 c4"><span></span></p><p class="c2"><span>2.4. Let&rsquo;s now implement the part of the client responsible for opening a socket and sending a message to the server. To do this work without blocking the UI thread, which would make the app unresponsive to the user, we will do it in background using an </span><span class="c9">AsyncTask</span><span>&nbsp;class, as shown below. Add this code to a new file </span><span class="c9">ClientConnectorTask.java</span><span>.</span></p><p class="c2 c4"><span></span></p><a href="#" name="b6f1ed5345f9e01a7d180b563f1a181e25fceeb9"></a><a href="#" name="4"></a><table cellpadding="0" cellspacing="0" class="c5"><tbody><tr><td class="c13"><p class="c1"><span class="c3">package pt.utl.ist.cmov.csclient;</span></p><p class="c1 c4"><span class="c3"></span></p><p class="c1"><span class="c3">import java.io.IOException;</span></p><p class="c1"><span class="c3">import java.io.PrintWriter;</span></p><p class="c1"><span class="c3">import java.net.Socket;</span></p><p class="c1"><span class="c3">import java.net.UnknownHostException;</span></p><p class="c1 c4"><span class="c3"></span></p><p class="c1"><span class="c3">import android.os.AsyncTask;</span></p><p class="c1 c4"><span class="c3"></span></p><p class="c1"><span class="c3">public class ClientConnectorTask extends AsyncTask&lt;String, Void, Integer&gt; {</span></p><p class="c1 c4"><span class="c3"></span></p><p class="c1"><span class="c3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;private Socket client;</span></p><p class="c1"><span class="c3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;private PrintWriter printwriter;</span></p><p class="c1 c4"><span class="c3"></span></p><p class="c1"><span class="c3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;protected Integer doInBackground(String...strings) {</span></p><p class="c1 c4"><span class="c3"></span></p><p class="c1"><span class="c3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// validate input parameters</span></p><p class="c1"><span class="c3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (strings.length &lt;= 0) {</span></p><p class="c1"><span class="c3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return 0;</span></p><p class="c1"><span class="c3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></p><p class="c1 c4"><span class="c3"></span></p><p class="c1"><span class="c3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// connect to the server and send the message</span></p><p class="c1"><span class="c3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try {</span></p><p class="c1"><span class="c3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;client = new Socket(&quot;10.0.2.2&quot;, 4444);</span></p><p class="c1"><span class="c3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;printwriter = new PrintWriter(client.getOutputStream(),true);</span></p><p class="c1"><span class="c3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;printwriter.write(strings[0]);</span></p><p class="c1"><span class="c3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;printwriter.flush();</span></p><p class="c1"><span class="c3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;printwriter.close();</span></p><p class="c1"><span class="c3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;client.close();</span></p><p class="c1"><span class="c3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} catch (UnknownHostException e) {</span></p><p class="c1"><span class="c3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;e.printStackTrace();</span></p><p class="c1"><span class="c3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} catch (IOException e) {</span></p><p class="c1"><span class="c3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;e.printStackTrace();</span></p><p class="c1"><span class="c3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></p><p class="c1"><span class="c3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return 0;</span></p><p class="c1"><span class="c3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></p><p class="c1 c4"><span class="c3"></span></p><p class="c1"><span class="c3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;protected void onPostExecute(Long result) {</span></p><p class="c1"><span class="c3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return;</span></p><p class="c1"><span class="c3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></p><p class="c1"><span class="c3">}</span></p></td></tr></tbody></table><p class="c2 c4"><span></span></p><p class="c2"><span>2.5. Finally, tie the previous code with the UI by instantiating the </span><span class="c9">AsyncTask</span><span>&nbsp;in the handler of the the button&rsquo;s </span><span class="c9">onClick</span><span>&nbsp;event. The handler is located in </span><span class="c9">MainActivity.java</span><span>, which now looks like this:</span></p><p class="c2 c4"><span></span></p><a href="#" name="e397d7463f50e0158cf4f27370c0a79c52695da3"></a><a href="#" name="5"></a><table cellpadding="0" cellspacing="0" class="c5"><tbody><tr class="c16"><td class="c13"><p class="c1"><span class="c3">package pt.utl.ist.cmov.csclient;</span></p><p class="c1 c4"><span class="c3"></span></p><p class="c1"><span class="c3">import android.app.Activity;</span></p><p class="c1"><span class="c3">import android.os.Bundle;</span></p><p class="c1"><span class="c3">import android.view.View;</span></p><p class="c1"><span class="c3">import android.widget.Button;</span></p><p class="c1"><span class="c3">import android.widget.EditText;</span></p><p class="c1 c4"><span class="c3"></span></p><p class="c1"><span class="c3">public class MainActivity extends Activity {</span></p><p class="c1 c4"><span class="c3"></span></p><p class="c1"><span class="c3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;private EditText textField;</span></p><p class="c1"><span class="c3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;private Button button;</span></p><p class="c1"><span class="c3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;private String message;</span></p><p class="c1 c4"><span class="c3"></span></p><p class="c1"><span class="c3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@Override</span></p><p class="c1"><span class="c3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public void onCreate(Bundle savedInstanceState) {</span></p><p class="c1"><span class="c3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;super.onCreate(savedInstanceState);</span></p><p class="c1"><span class="c3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;setContentView(R.layout.main);</span></p><p class="c1 c4"><span class="c3"></span></p><p class="c1"><span class="c3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;textField = (EditText) findViewById(R.id.editText1);</span></p><p class="c1"><span class="c3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;button = (Button) findViewById(R.id.button1);</span></p><p class="c1 c4"><span class="c3"></span></p><p class="c1"><span class="c3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//Button press event listener</span></p><p class="c1"><span class="c3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;button.setOnClickListener(new View.OnClickListener() {</span></p><p class="c1"><span class="c3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public void onClick(View v) {</span></p><p class="c1"><span class="c3 c12">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;message = textField.getText().toString();</span></p><p class="c1"><span class="c3 c12">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;textField.setText(&quot;&quot;);</span></p><p class="c1"><span class="c3 c12">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;new ClientConnectorTask().execute(message);</span></p><p class="c1"><span class="c3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></p><p class="c1"><span class="c3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;});</span></p><p class="c1"><span class="c3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></p><p class="c1"><span class="c3">}</span></p></td></tr></tbody></table><p class="c2 c4"><span></span></p><p class="c2"><span>2.6 Launch the Android emulator. Create a new configuration called &ldquo;CMov-CS-Client&rdquo; for the client project, compile the client, and deploy it on the emulator.</span></p><p class="c2 c4"><span></span></p><p class="c2"><span>3. Test the application: Write a message on the client, press the &ldquo;Send&rdquo; button, and check that the message shows up on the server&rsquo;s console. Rebuilding the client- and the server-sides can be done independently by choosing the respective build configuration (under the button </span><img height="20" src="images/image00.png" width="20"><span>).</span></p><p class="c2 c4"><span></span></p><p class="c2"><span>4. Now that the client-server works, spend a few minutes to understand the details of this app:</span></p><p class="c2 c18"><span>a) Learn how the networking works in the emulator. Read the page:</span></p><p class="c2 c18"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c6"><a class="c0" href="http://developer.android.com/tools/devices/emulator.html">http://developer.android.com/tools/devices/emulator.html</a></span></p><p class="c2 c18"><span>b) Learn how the </span><span class="c9">AsyncTask</span><span>&nbsp;class works. Take a look at the following link:</span></p><p class="c2 c10"><span class="c6"><a class="c0" href="http://developer.android.com/reference/android/os/AsyncTask.html">http://developer.android.com/reference/android/os/AsyncTask.html</a></span></p><h3 class="c2"><a name="h.dqy4ze64w9zg"></a><span>2.2 Fetching an Image from the Web</span></h3><p class="c2"><span>The previous assignment has shown how networking works using the low-level socket API. Now we learn how to use a higher level API for fetching the IST logo from the Web and displaying it on the screen. To implement this assignment, we again use the </span><span class="c9">AsyncTask</span><span>&nbsp;class for fetching an image in background, and learn new primitives for accessing the Web and manipulating graphics.</span></p><p class="c2 c4"><span></span></p><p class="c2"><span>1. Create a clean slate Android application project called &ldquo;CMov-NetPhoto&rdquo;.</span></p><p class="c2 c4"><span></span></p><p class="c2"><span>2. Modify the layout so that the screen shows a single button for triggering the image download. Make sure that the body of the XML tag </span><span class="c9">RelativeLayout</span><span>&nbsp;located in file </span><span class="c9">res/layout/activity_main.xml</span><span>&nbsp;has the following content:</span></p><p class="c2 c4"><span></span></p><a href="#" name="d902b5a8d86cde785d1c02098f18db2ca14f4da7"></a><a href="#" name="6"></a><table cellpadding="0" cellspacing="0" class="c5"><tbody><tr><td class="c13"><p class="c1"><span class="c3">&nbsp; &nbsp; &lt;Button android:id=&quot;@+id/button1&quot;</span></p><p class="c1"><span class="c3">&nbsp; &nbsp; &nbsp; &nbsp; android:layout_gravity=&quot;center&quot;</span></p><p class="c1"><span class="c3">&nbsp; &nbsp; &nbsp; &nbsp; android:layout_height=&quot;wrap_content&quot;</span></p><p class="c1"><span class="c3">&nbsp; &nbsp; &nbsp; &nbsp; android:layout_width=&quot;wrap_content&quot;</span></p><p class="c1"><span class="c3">&nbsp; &nbsp; &nbsp; &nbsp; android:text=&quot;@string/load&quot;&gt; </span></p><p class="c1"><span class="c3">&nbsp; &nbsp; &lt;/Button&gt;</span></p></td></tr></tbody></table><p class="c2 c4"><span></span></p><p class="c2"><span>As in the previous exercise, don&rsquo;t forget to update </span><span class="c9">values/string.xml</span><span>&nbsp;with a value (e.g., &ldquo;Load&rdquo;) for the string &ldquo;@string/load&rdquo; referenced in the layout file. This string will be featuring the button&rsquo;s face.</span></p><p class="c2 c4"><span></span></p><p class="c2"><span>3. Update the manifest in order to give the app permission to the Internet, i.e. add the lines:</span></p><p class="c2 c4"><span></span></p><a href="#" name="e38ea5948ee287d7875dd696c3af654002e64342"></a><a href="#" name="7"></a><table cellpadding="0" cellspacing="0" class="c5"><tbody><tr class="c16"><td class="c13"><p class="c1"><span class="c3">&nbsp; &nbsp; &lt;uses-permission android:name=&quot;android.permission.INTERNET&quot;&gt;</span></p><p class="c1"><span class="c3">&nbsp; &nbsp; &lt;/uses-permission&gt;</span></p></td></tr></tbody></table><p class="c2 c4"><span></span></p><p class="c2"><span>4. Now, let&rsquo;s add some code to the button&rsquo;s </span><span class="c9">onClick</span><span>&nbsp;event. The code implements an </span><span class="c9">AsynkTask</span><span>&nbsp;that retrieves an image (a </span><span class="c9">BitMap</span><span>) from the Web. The </span><span class="c9">BitMap</span><span>&nbsp;factory of the Android framework enables to instantiate a BitMap object based on a URL, from which the factory automatically fetches the image data. (Note: the background task is implemented as class </span><span class="c9">PhotoDownloaderTask</span><span>, which is private to the </span><span class="c9">MainActivity</span><span>&nbsp;class.)</span></p><p class="c2 c4"><span></span></p><a href="#" name="0e8986591b01873c1a4507443732aea3b2389ca1"></a><a href="#" name="8"></a><table cellpadding="0" cellspacing="0" class="c5"><tbody><tr class="c16"><td class="c13"><p class="c1"><span class="c3">public class MainActivity extends Activity {</span></p><p class="c1 c4"><span class="c3"></span></p><p class="c1"><span class="c3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;private Button button;</span></p><p class="c1"><span class="c3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p><p class="c1"><span class="c3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@Override</span></p><p class="c1"><span class="c3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;protected void onCreate(Bundle savedInstanceState) {</span></p><p class="c1"><span class="c3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;super.onCreate(savedInstanceState);</span></p><p class="c1"><span class="c3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;setContentView(R.layout.activity_main);</span></p><p class="c1"><span class="c3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p><p class="c1"><span class="c3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;button = (Button) findViewById(R.id.button1);</span></p><p class="c1 c4"><span class="c3"></span></p><p class="c1"><span class="c3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//Button press event listener</span></p><p class="c1"><span class="c3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;button.setOnClickListener(new View.OnClickListener() {</span></p><p class="c1 c4"><span class="c3"></span></p><p class="c1"><span class="c3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public void onClick(View v) {</span></p><p class="c1"><span class="c3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String url = </span></p><p class="c1"><span class="c3">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;http://upload.wikimedia.org/wikipedia/pt/e/ed/IST_Logo.png&quot;;</span></p><p class="c1"><span class="c3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;new PhotoDownloaderTask().execute(url);</span></p><p class="c1"><span class="c3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></p><p class="c1"><span class="c3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;});</span></p><p class="c1"><span class="c3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></p><p class="c1 c4"><span class="c3"></span></p><p class="c1"><span class="c3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;private class PhotoDownloaderTask extends AsyncTask&lt;String, Void, Bitmap&gt; {</span></p><p class="c1"><span class="c3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; &nbsp;protected Bitmap doInBackground(String... urls) {</span></p><p class="c1"><span class="c3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;return loadImageFromNetwork(urls[0]);</span></p><p class="c1"><span class="c3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; &nbsp;}</span></p><p class="c1 c4"><span class="c3"></span></p><p class="c1"><span class="c3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; &nbsp;protected void onPostExecute(Bitmap result) {</span></p><p class="c1"><span class="c3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;//Do something with bitmap eg:</span></p><p class="c1"><span class="c3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; &nbsp;}</span></p><p class="c1"><span class="c3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></p><p class="c1 c4"><span class="c3"></span></p><p class="c1"><span class="c3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;private Bitmap loadImageFromNetwork(String url){</span></p><p class="c1"><span class="c3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; &nbsp; try {</span></p><p class="c1"><span class="c3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Bitmap bitmap = </span></p><p class="c1"><span class="c3">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; BitmapFactory.decodeStream((InputStream)new URL(url).getContent());</span></p><p class="c1"><span class="c3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return bitmap;</span></p><p class="c1"><span class="c3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; &nbsp; } catch (Exception e) {</span></p><p class="c1"><span class="c3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; e.printStackTrace(); return null;</span></p><p class="c1 c4"><span class="c3"></span></p><p class="c1"><span class="c3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; }</span></p><p class="c1"><span class="c3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></p><p class="c1"><span class="c3">}</span></p></td></tr></tbody></table><p class="c2 c4"><span></span></p><p class="c2"><span>5. Display the image on the screen. To do this, make an instance of </span><span class="c9">ImageView</span><span>&nbsp;in the </span><span class="c9">onCreate</span><span>&nbsp;method of the </span><span class="c9">MainActivity</span><span>, and set the instance to the BitMap object containing the downloaded image. Set the instance in the </span><span class="c9">onPostExecute</span><span>&nbsp;method of </span><span class="c9">PhotoDownloaderTask</span><span>.</span></p><p class="c2 c4"><span></span></p><a href="#" name="fe176cbf58f21f421dba56a99607480d20f11f65"></a><a href="#" name="9"></a><table cellpadding="0" cellspacing="0" class="c5"><tbody><tr class="c16"><td class="c13"><p class="c1"><span class="c3">public class MainActivity extends Activity {</span></p><p class="c1"><span class="c3">&nbsp; &nbsp; &nbsp; &nbsp;...</span></p><p class="c1"><span class="c3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;private ImageView mImageView;</span></p><p class="c1"><span class="c3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p><p class="c1"><span class="c3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@Override</span></p><p class="c1"><span class="c3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;protected void onCreate(Bundle savedInstanceState) {</span></p><p class="c1"><span class="c3">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;...</span></p><p class="c1"><span class="c3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mImageView = new ImageView(this);</span></p><p class="c1"><span class="c3">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;...</span></p><p class="c1"><span class="c3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></p><p class="c1 c4"><span class="c3"></span></p><p class="c1"><span class="c3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;private class PhotoDownloaderTask extends AsyncTask&lt;String, Void, Bitmap&gt; {</span></p><p class="c1"><span class="c3">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ...</span></p><p class="c1"><span class="c3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; &nbsp;protected void onPostExecute(Bitmap result) {</span></p><p class="c1"><span class="c3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;mImageView.setImageBitmap(result);</span></p><p class="c1"><span class="c3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;setContentView(mImageView);</span></p><p class="c1"><span class="c3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; &nbsp;}</span></p><p class="c1"><span class="c3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></p></td></tr></tbody></table><p class="c2 c4"><span></span></p><p class="c2"><span>6. Compile the app, and test it on the emulator. Press the button &ldquo;Load&rdquo; and </span><span class="c9">voila</span><span>!</span></p><p class="c2 c4"><span></span></p><p class="c2"><span>7. This example is extremely simple. In a real world application, many other issues would have to be addressed. For example, oversized images require more efficient methods for their retrieval, and network errors must be handled properly. To find out more about fetching large images, go to: </span></p><p class="c2 c14"><span class="c6"><a class="c0" href="http://developer.android.com/training/displaying-bitmaps/index.html">http://developer.android.com/training/displaying-bitmaps/index.html</a></span></p><h2 class="c2"><a name="h.v9vspcsgbbqz"></a><span>3. Learn More</span></h2><p class="c2"><span>Here&rsquo;s additional directions that we recommend to a beginner in Android app development.</span></p><h3 class="c2"><a name="h.6a4lwzo888z9"></a><span>Best practices for user experience and UI</span></h3><p class="c2 c4"><span></span></p><p class="c2"><span class="c12">Designing effective navigation:</span><span>&nbsp;How to plan your app&#39;s screen hierarchy and forms of navigation so users can effectively and intuitively traverse your app content using various navigation patterns.</span></p><p class="c2 c14"><span class="c6"><a class="c0" href="http://developer.android.com/training/design-navigation/index.html">http://developer.android.com/training/design-navigation/index.html</a></span></p><p class="c2 c4"><span></span></p><p class="c2"><span class="c12">Implementing effective navigation:</span><span>&nbsp;How to implement various navigation patterns such as swipe views and up navigation. (Includes an example.)</span></p><p class="c2 c14"><span class="c6"><a class="c0" href="http://developer.android.com/training/implementing-navigation/index.html">http://developer.android.com/training/implementing-navigation/index.html</a></span></p><p class="c2 c4"><span></span></p><p class="c2"><span class="c12">Notifying the user:</span><span>&nbsp;A notification is a user interface element that you display outside your app&#39;s normal UI to indicate that an event has occurred. Users can choose to view the notification while using other apps and respond to it when it&#39;s convenient for them.</span></p><p class="c2 c14"><span class="c6"><a class="c0" href="http://developer.android.com/training/notify-user/index.html">http://developer.android.com/training/notify-user/index.html</a></span></p><h3 class="c2"><a name="h.y4egecnyagyj"></a><span>Best practices for security and privacy</span></h3><p class="c2 c4"><span></span></p><p class="c2"><span class="c12">Security tips:</span><span>&nbsp;How to perform various tasks and keep your app&#39;s data and your user&#39;s data secure.</span></p><p class="c2 c14"><span class="c6"><a class="c0" href="http://developer.android.com/training/articles/security-tips.html">http://developer.android.com/training/articles/security-tips.html</a></span></p><h3 class="c2"><a name="h.4ud3kcnvfnfw"></a><span>Best practices for performance</span></h3><p class="c2 c4"><span></span></p><p class="c2"><span class="c12">Performance tips:</span><span>&nbsp;This document primarily covers micro-optimizations that can improve overall app performance when combined.</span></p><p class="c2 c11"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c6"><a class="c0" href="http://developer.android.com/training/articles/perf-tips.html">http://developer.android.com/training/articles/perf-tips.html</a></span></p><p class="c2 c4"><span></span></p><p class="c2"><span class="c12">Running in a background service: </span><span>Unless you specify otherwise, most of the operations you do in an app run in the foreground on a special thread called the UI thread. This can cause problems, because long-running operations will interfere with the responsiveness of your user interface. To avoid this, the Android framework offers several classes that help you off-load operations onto a separate thread running in the background.</span></p><p class="c2"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c6"><a class="c0" href="http://developer.android.com/training/run-background-service/index.html">http://developer.android.com/training/run-background-service/index.html</a></span></p><p class="c2 c4"><span></span></p><p class="c2"><span class="c12">Optimizing battery life: </span><span>For your app to be a good citizen, it should seek to limit its impact on the battery life of its host device. After this class you will be able to build apps that monitor modify their functionality and behavior based on the state of the host device.</span></p><p class="c2"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c6"><a class="c0" href="http://developer.android.com/training/monitoring-device-state/index.html">http://developer.android.com/training/monitoring-device-state/index.html</a></span></p><h3 class="c2"><a name="h.umds6foqm8uc"></a><span>Managing the execution flow</span></h3><p class="c2 c4"><span></span></p><p class="c2"><span class="c12">Managing the activity lifecycle:</span><span>&nbsp;As a user navigates through, out of, and back to your app, the </span><span>Activity</span><span>&nbsp;instances in your app transition between different states in their lifecycle. This class explains important lifecycle callback methods that each </span><span>Activity</span><span>&nbsp;instance receives and how you can use them so your activity does what the user expects and does not consume system resources when your activity doesn&#39;t need them. (Includes a demo.)</span></p><p class="c2 c11 c14"><span class="c6"><a class="c0" href="http://developer.android.com/training/basics/activity-lifecycle/index.html">http://developer.android.com/training/basics/activity-lifecycle/index.html</a></span></p><p class="c2 c11 c4"><span></span></p><p class="c2"><span class="c12">Processes and threads: </span><span>Learn</span><span>&nbsp;how processes and threads work in an Android application.</span></p><p class="c2 c11 c14"><span class="c6"><a class="c0" href="http://developer.android.com/guide/components/processes-and-threads.html">http://developer.android.com/guide/components/processes-and-threads.html</a></span></p><p class="c2 c11 c4"><span></span></p><p class="c2 c11"><span class="c8">Handling data</span></p><p class="c2 c4 c11"><span></span></p><p class="c2"><span class="c12">Saving data:</span><span>&nbsp;Most Android apps need to save data, even if only to save information about the app state during </span><span>onPause()</span><span>&nbsp;so the user&#39;s progress is not lost. Most non-trivial apps also need to save user settings, and some apps must manage large amounts of information in files and databases. This class introduces you to the principal data storage options in Android. (Includes an example.)</span></p><p class="c2 c11 c14"><span class="c6"><a class="c0" href="http://developer.android.com/training/basics/data-storage/index.html">http://developer.android.com/training/basics/data-storage/index.html</a></span></p><p class="c2 c11 c4"><span></span></p><p class="c2"><span class="c12">Sharing content:</span><span>&nbsp;This class covers some common ways you can send and receive content between applications using </span><span>Intent</span><span>&nbsp;APIs and the </span><span>ActionProvider</span><span>&nbsp;object.</span></p><p class="c2 c11 c14"><span class="c6"><a class="c0" href="http://developer.android.com/training/sharing/index.html">http://developer.android.com/training/sharing/index.html</a></span></p><p class="c2 c11 c4"><span></span></p><p class="c2 c11"><span class="c8">Workflow</span></p><p class="c2 c11 c4"><span class="c8"></span></p><p class="c2"><span class="c12">Using the Android emulator: </span><span>The Android SDK includes a virtual mobile device emulator that runs on your computer. This document describes the features and limitations of the emulator.</span></p><p class="c2 c11 c14"><span class="c6"><a class="c0" href="http://developer.android.com/tools/devices/emulator.html">http://developer.android.com/tools/devices/emulator.html</a></span></p><div><p class="c2 c19"><span>/</span></p></div></body></html>